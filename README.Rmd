# BI-ENRICH-LN

Here is the reproducible code for BI-ENRICH pathway analysis that applied for figure 2 in the paper, Meta-analysis of over 100,000 individuals of European ancestry identifies 19 genome-wide significant risk loci for restless legs syndrome. 

## load data

```{r, eval=F}
load("data/annotation_matrix_gs.rda") # annotation_matrix_gs
colnames(annotation_matrix_gs)
```
A matrix indicate annotation of 16903 genes in 6121 gene sets.

```{r, eval=F}
load("data/candidategeneset.rda") # annotation_matrix_gs
head(cs) # two columns: gene name; loci id
```

## BI-ENRICH pathway enrichment

### calculate z score 

```{r, eval=F}

ncores = 2;                # number of cores for parallel computing
bienrich_pval = 0.05;      # p-value cutoff to perform greedy search for the potention multiple mixed gene sets.
shrinking_geneset = TRUE ; # shrinking the all the gene sets by full overlap, the larger one will be remove to accelerate computing 

source("src/calculate_geneset_zscore.R")

zcs2gs_res_list <- calculate_geneset_zscore( cs=cs,
										annotation_matrix_gs = annotation_matrix_gs, 
										ncores=ncores, 
										bienrich_pval=bienrich_pval,
										shrinking_geneset=TRUE)

zcs2gs_res <- zcs2gs_res_list[[1]]
annotation_matrix <- zcs2gs_res_list[[2]]
save(annotation_matrix,file="annotation_matrix_gs_sk.rda")
head(zcs2gs_res[order(zcs2gs_res[,1],decreasing=T),],3)
```
           z                   anno
104 5.689770 GO_LOCOMOTORY_BEHAVIOR
115 5.566328            GO_BEHAVIOR
14  5.480649     UNIKB_Neurogenesis

### calculate random sampling base z-score

```{r, eval=F}

```


